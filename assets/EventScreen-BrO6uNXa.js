import{r as d,j as n}from"./vendor-react-BBAiCqIe.js";import{u as x,m as y,E as c,S}from"./index-C7rUvnqQ.js";import"./vendor-other-D1HXEB8n.js";import"./vendor-zustand-CsJFGcav.js";import"./vendor-motion-DPidUVdd.js";function j(r,i){return r.requirements?!(r.requirements.gold&&i.gold<r.requirements.gold||r.requirements.reputation&&i.reputation<r.requirements.reputation||r.requirements.item&&!(Object.values(i.equipment).some(t=>(t==null?void 0:t.id)===r.requirements.item)||i.inventory.some(t=>t.id===r.requirements.item))||r.requirements.flag&&!i.npcFlags[r.requirements.flag]||r.requirements.humanite&&(i.narrativeCounters.humanite||0)<r.requirements.humanite||r.requirements.cynisme&&(i.narrativeCounters.cynisme||0)<r.requirements.cynisme||r.requirements.pragmatisme&&(i.narrativeCounters.pragmatisme||0)<r.requirements.pragmatisme):!0}function z(){const{eventResult:r,applyEventConsequence:i,finishEvent:o}=x(),t=y(),[u,p]=d.useState(null),[m,f]=d.useState(!1),[b,g]=d.useState(!1),l=r==null?void 0:r.eventId,a=c.find(e=>e.id===l);if(!a)return console.error("√âv√©nement non trouv√©:",{eventId:l,availableIds:c.map(e=>e.id),eventResult:r}),n.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"#ccc"},children:[n.jsx("div",{style:{fontSize:"1.2rem",marginBottom:"1rem",color:"#c44"},children:"√âv√©nement non trouv√©"}),n.jsxs("div",{style:{fontSize:"0.9rem",marginBottom:"1rem",color:"#888"},children:["ID: ",l||"undefined"]}),n.jsx("button",{onClick:o,style:{marginTop:"1rem",padding:"0.75rem 1.5rem",fontSize:"1rem",background:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",color:"#ccc",cursor:"pointer"},children:"RETOUR"})]});const q=e=>{p(e),f(!0),i(e.consequences),(e.consequences.debt||e.consequences.durabilityLoss||e.consequences.gold&&e.consequences.gold<-10)&&(g(!0),setTimeout(()=>g(!1),500))},v=()=>{p(null),f(!1),o()};return n.jsx(S,{intensity:3,duration:400,trigger:b,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",flex:1,position:"relative",padding:"1rem",maxWidth:"600px",margin:"0 auto",width:"100%"},children:[n.jsxs("div",{style:{flex:1,overflowY:"auto",overflowX:"hidden",paddingBottom:"140px",WebkitOverflowScrolling:"touch"},children:[n.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",textAlign:"center",marginBottom:"1rem",color:"#fff"},children:a.title}),n.jsx("div",{style:{background:"#2a2a2a",padding:"1.5rem",borderRadius:"8px",border:"2px solid #555",fontSize:"1rem",lineHeight:"1.6",color:"#ccc",marginBottom:"1.5rem"},children:a.description}),m&&u&&n.jsx("div",{style:{background:"#2a1a1a",padding:"1.5rem",borderRadius:"8px",border:"1px solid #555",fontSize:t?"1rem":"0.95rem",lineHeight:"1.6",color:"#ca8",fontStyle:"italic",marginBottom:"1.5rem"},children:u.consequences.narrative||"Tu as fait ton choix."})]}),n.jsxs("div",{style:{position:"absolute",bottom:0,left:0,right:0,zIndex:10,padding:"1rem",background:"linear-gradient(to top, rgba(0, 0, 0, 0.95) 0%, rgba(0, 0, 0, 0.85) 70%, transparent 100%)",borderTop:"1px solid #333"},children:[!m&&n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:a.choices.map(e=>{const s=j(e,x.getState());return n.jsxs("button",{onClick:()=>q(e),disabled:!s,style:{padding:"1rem",fontSize:"1rem",minHeight:t?"48px":"44px",textAlign:"left",background:s?"#1a1a1a":"#0a0a0a",border:`1px solid ${s?"#555":"#333"}`,borderRadius:"4px",color:s?"#ddd":"#999",cursor:s?"pointer":"not-allowed",opacity:s?1:.5,boxShadow:"0 -2px 8px rgba(0, 0, 0, 0.3)"},children:[e.text,!s&&e.requirements&&n.jsxs("div",{style:{fontSize:"0.8rem",color:"#888",marginTop:"0.25rem"},children:[e.requirements.gold&&`(Besoin: ${e.requirements.gold}üí∞)`,e.requirements.reputation&&`(Besoin: ${e.requirements.reputation}‚≠ê)`,e.requirements.item&&`(Besoin: ${e.requirements.item})`,e.requirements.humanite&&`(Besoin: Humanit√© ${e.requirements.humanite}+)`,e.requirements.cynisme&&`(Besoin: Cynisme ${e.requirements.cynisme}+)`,e.requirements.pragmatisme&&`(Besoin: Pragmatisme ${e.requirements.pragmatisme}+)`]})]},e.id)})}),m&&n.jsx("button",{onClick:v,style:{fontSize:t?"1rem":"1.1rem",padding:"1rem",minHeight:t?"48px":"44px",width:"100%",background:"#2a2a2a",border:"1px solid #555",borderRadius:"4px",color:"#fff",cursor:"pointer",boxShadow:"0 -2px 8px rgba(0, 0, 0, 0.3)"},children:"CONTINUER"})]})]})})}export{z as default};

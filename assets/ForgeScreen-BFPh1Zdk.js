import{r as u,j as e}from"./vendor-react-BBAiCqIe.js";import{u as D,i as W,j as w,k as F,l as n,d as y,e as b,D as j}from"./index-C7rUvnqQ.js";import"./vendor-other-D1HXEB8n.js";import"./vendor-zustand-CsJFGcav.js";import"./vendor-motion-DPidUVdd.js";function q(){const{equipment:v,inventory:a,gold:l,reputation:c,forgeStock:t,repairItem:R,buyForgeItem:S,generateForgeStock:p,closeInventory:z,narrativeCounters:A}=D(),[m,C]=u.useState(!1),[r,x]=u.useState(null);u.useEffect(()=>{t===null&&p(),m||C(!0)},[t,p,m]);const d=[];Object.entries(v).forEach(([i,o])=>{o&&o.durability<o.maxDurability&&d.push({item:o,location:"equipment",slot:i})}),a.forEach(i=>{i.durability<i.maxDurability&&d.push({item:i,location:"inventory"})});const k=i=>{R(i)&&x(null)},B=()=>{t&&S(t)},E=r?r.durability/r.maxDurability*100:100,f=r?w(E,c):F(c);return e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.5rem",flex:1,padding:"1rem",overflowY:"auto"},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",marginBottom:"0.5rem"},children:"FORGE DE BERTRAM"}),e.jsxs("div",{style:{fontSize:"1rem",color:"#aaa"},children:["Or : ",e.jsxs("span",{style:{color:"#ca8",fontWeight:"bold"},children:[l,"ðŸ’°"]})," | ","RÃ©putation : ",e.jsx("span",{style:{color:"#ddd"},children:"â­".repeat(c)})]})]}),e.jsxs("div",{style:{background:"#2a2a2a",padding:"1rem",borderRadius:"8px",border:"2px solid #555"},children:[e.jsxs("div",{style:{fontSize:"0.9rem",color:"#aaa",fontStyle:"italic",lineHeight:"1.6",marginBottom:"0.5rem"},children:['"',W(m),'"']}),r&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"#ca8",fontStyle:"italic",lineHeight:"1.6"},children:['"',f,'"']}),!r&&e.jsxs("div",{style:{fontSize:"0.9rem",color:"#888",fontStyle:"italic",lineHeight:"1.6"},children:['"',f,'"']})]}),e.jsxs("div",{style:{background:"#2a2a2a",padding:"1rem",borderRadius:"8px",border:"2px solid #555"},children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"1rem"},children:"RÃ‰PARATION"}),d.length===0?e.jsx("div",{style:{color:"#888",fontStyle:"italic",textAlign:"center",padding:"1rem"},children:"Aucun item Ã  rÃ©parer"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:d.map(({item:i,location:o,slot:I})=>{const g=n(i,A),h=y(i.rarity),s=l>=g;return e.jsxs("div",{style:{background:"#1a1a1a",padding:"0.75rem",borderRadius:"4px",border:`1px solid ${h}`,display:"flex",flexDirection:"column",gap:"0.5rem",opacity:s?1:.6},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:"bold",color:h},children:i.name}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#888"},children:[b(i.rarity)," ",o==="equipment"?"(Ã‰quipÃ©)":""]})]}),e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:s?"#ca8":"#c44"},children:[g,"ðŸ’°"]})]}),e.jsx(j,{item:i,size:"small",showLabel:!0}),e.jsx("button",{onClick:()=>x(i),disabled:!s,style:{fontSize:"0.9rem",padding:"0.5rem",opacity:s?1:.5,cursor:s?"pointer":"not-allowed"},children:"RÃ‰PARER"})]},`${o}_${i.id}_${I||""}`)})})]}),t&&e.jsxs("div",{style:{background:"#2a2a2a",padding:"1rem",borderRadius:"8px",border:"2px solid #555"},children:[e.jsx("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"1rem"},children:"OBJET ARTISANAL"}),e.jsxs("div",{style:{background:"#1a1a1a",padding:"0.75rem",borderRadius:"4px",border:`2px solid ${y(t.rarity)}`,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"1rem",fontWeight:"bold",color:y(t.rarity)},children:t.name}),e.jsxs("div",{style:{fontSize:"0.8rem",color:"#888"},children:[b(t.rarity)," â€” QualitÃ© artisanale"]})]}),e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:"bold",color:l>=t.value*2?"#ca8":"#c44"},children:[t.value*2,"ðŸ’°"]})]}),e.jsx(j,{item:t,size:"small",showLabel:!1}),e.jsx("button",{onClick:B,disabled:l<t.value*2||a.length>=10,style:{fontSize:"0.9rem",padding:"0.5rem",opacity:l>=t.value*2&&a.length<10?1:.5,cursor:l>=t.value*2&&a.length<10?"pointer":"not-allowed"},children:"ACHETER"})]})]}),e.jsx("button",{onClick:z,style:{fontSize:"1rem",padding:"1rem",width:"100%"},children:"RETOUR"}),r&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"#2a2a2a",padding:"2rem",borderRadius:"8px",border:"2px solid #555",maxWidth:"400px",width:"90%"},children:[e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"bold",marginBottom:"1rem",textAlign:"center"},children:["RÃ©parer ",r.name," ?"]}),e.jsxs("div",{style:{fontSize:"1.1rem",textAlign:"center",marginBottom:"1.5rem",color:l>=n(r)?"#ca8":"#c44"},children:[n(r),"ðŸ’°"]}),l<n(r)&&e.jsx("div",{style:{color:"#c44",textAlign:"center",marginBottom:"1rem",fontSize:"0.9rem"},children:"Or insuffisant"}),e.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[e.jsx("button",{onClick:()=>x(null),style:{flex:1},children:"ANNULER"}),e.jsx("button",{onClick:()=>k(r),disabled:l<n(r),style:{flex:1,background:"#3a2a2a",opacity:l>=n(r)?1:.5},children:"RÃ‰PARER"})]})]})})]})}export{q as default};
